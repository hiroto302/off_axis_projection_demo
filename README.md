# Off-Axis Projection Demo

MediaPipe Face Detection ã¨ Three.js ã‚’ä½¿ç”¨ã—ãŸ **off-axis projectionï¼ˆéå¯¾ç§°è¦–éŒå°æŠ•å½±ï¼‰** ã®ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é¡”ä½ç½®ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã—ã€ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ãŒã‚ãŸã‹ã‚‚3Dç©ºé–“ã¸ã®ã€Œçª“ã€ã®ã‚ˆã†ã«è¦‹ãˆã‚‹åŠ¹æœã‚’å®Ÿç¾ã—ã¾ã™ã€‚

![Off-Axis Projection Demo](https://img.shields.io/badge/status-deployed-success)
![License](https://img.shields.io/badge/license-MIT-blue)

## ğŸ¥ ãƒ‡ãƒ¢

**Live Demo:** [https://snsnap1159.github.io/off_axis_projection_demo/](https://snsnap1159.github.io/off_axis_projection_demo/)

> âš ï¸ **æ³¨æ„:** ã‚«ãƒ¡ãƒ©ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…é ˆã§ã™ã€‚Google Chromeï¼ˆæœ€æ–°ç‰ˆï¼‰ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

## âœ¨ ç‰¹å¾´

- ğŸ“¹ **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é¡”ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°**: MediaPipe Face Detectionã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªé¡”ä½ç½®æ¤œå‡º
- ğŸ¬ **Off-Axis Projection**: é ­ã®å‹•ãã«å¿œã˜ã¦3Dç©ºé–“ã®è¦–ç‚¹ãŒå‹•çš„ã«å¤‰åŒ–
- ğŸ® **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒãƒƒã‚°UI**: lil-guiã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´
- âš¡ **é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: 60fpså®‰å®šå‹•ä½œï¼ˆé¡”æ¤œå‡º30fps + ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°60fpsï¼‰
- ğŸ“± **HTTPSå¯¾å¿œ**: GitHub Pagesã§ã‚»ã‚­ãƒ¥ã‚¢ã«ãƒ‡ãƒ—ãƒ­ã‚¤

## ğŸš€ ä½¿ã„æ–¹

1. ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚«ãƒ¡ãƒ©ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯
3. é¡”ã‚’ã‚«ãƒ¡ãƒ©ã«å‘ã‘ã‚‹
4. é ­ã‚’å·¦å³ãƒ»å‰å¾Œã«å‹•ã‹ã—ã¦3Dç©ºé–“ã‚’æ¢ç´¢ï¼

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **[Three.js](https://threejs.org/)** (r161ä»¥é™) - 3Dãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³
- **[MediaPipe Face Detection](https://developers.google.com/mediapipe/solutions/vision/face_detector)** - é¡”ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
- **[Vite](https://vitejs.dev/)** - é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼†ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«
- **[lil-gui](https://lil-gui.georgealways.com/)** - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´UI
- **Vanilla JavaScript** - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ¬ã‚¹å®Ÿè£…

## ğŸ“¦ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

### å‰ææ¡ä»¶

- Node.js 18ä»¥é™
- npm ã¾ãŸã¯ yarn
- Webã‚«ãƒ¡ãƒ©æ­è¼‰ãƒ‡ãƒã‚¤ã‚¹

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/snsnap1159/off_axis_projection_demo.git
cd off_axis_projection_demo

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```
ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5173` ã‚’é–‹ãã¾ã™ã€‚
> âš ï¸ **HTTPSæ³¨æ„:** ã‚«ãƒ¡ãƒ©ã‚¢ã‚¯ã‚»ã‚¹ã«ã¯é€šå¸¸HTTPSãŒå¿…è¦ã§ã™ãŒã€`localhost`ã¯ä¾‹å¤–ã¨ã—ã¦è¨±å¯ã•ã‚Œã¾ã™ã€‚

### ãƒ“ãƒ«ãƒ‰

```bash
npm run build
```

`dist/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

```bash
npm run preview
```

ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã¾ã™ã€‚

## ğŸ› ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´

ç”»é¢å³ä¸Šã®lil-guiãƒ‘ãƒãƒ«ã‹ã‚‰ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã§ãã¾ã™ï¼š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ç¯„å›² | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|----------|------|-----------|------|
| **Smoothing** | 0.01 - 0.5 | 0.1 | é ­éƒ¨ç§»å‹•ã®ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°å¼·åº¦ï¼ˆä½ã„=æ»‘ã‚‰ã‹ã€é«˜ã„=åå¿œé€Ÿï¼‰ |
| **Scale** | 0.5 - 5.0 | 2.0 | é ­éƒ¨ç§»å‹•ã¨ã‚«ãƒ¡ãƒ©ã‚ªãƒ•ã‚»ãƒƒãƒˆã®å€ç‡ |
| **Viewing Distance** | 30 - 100cm | 60cm | æƒ³å®šè¦–è´è·é›¢ï¼ˆãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‹ã‚‰ã®è·é›¢ï¼‰ |
| **Screen Width** | 20 - 50cm | 33.8cm | ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã®ç‰©ç†å¹… |
| **Show Video** | - | OFF | ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’ç”»é¢ã«è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰ |
| **Show Stats** | - | OFF | FPSã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’è¡¨ç¤º |

## ğŸ— ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
off_axis_projection_demo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.js                    # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ style.css                  # ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ faceDetector.js       # MediaPipe Face Detectionç®¡ç†
â”‚   â”‚   â”œâ”€â”€ threeScene.js         # Three.jsã‚·ãƒ¼ãƒ³æ§‹ç¯‰
â”‚   â”‚   â”œâ”€â”€ cameraController.js   # Off-axis projectionè¨ˆç®—
â”‚   â”‚   â””â”€â”€ smoothing.js          # EMAã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°å®Ÿè£…
â”œâ”€â”€ index.html                     # HTMLã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ vite.config.js                # Viteè¨­å®š
â”œâ”€â”€ package.json                  # ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ TODO.md                       # å®Ÿè£…è¨ˆç”»
â”œâ”€â”€ CLAUDE.md                     # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜æ›¸
â””â”€â”€ README.md                     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ”¬ æŠ€è¡“ä»•æ§˜

### Off-Axis Projectionå®Ÿè£…

**ã‚«ã‚¹ã‚¿ãƒ Frustumè¨ˆç®—æ–¹å¼**ã‚’æ¡ç”¨ï¼ˆ`PerspectiveCamera.setViewOffset()`ã¯ä½¿ç”¨ã›ãšï¼‰ï¼š

- è¦–ç‚¹ä½ç½®ã«åŸºã¥ã„ã¦ã‚«ã‚¹ã‚¿ãƒ è¦–éŒå°ï¼ˆfrustumï¼‰ã‚’è¨ˆç®—
- `camera.projectionMatrix.makePerspective()`ã§ç›´æ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è¡Œåˆ—ã‚’è¨­å®š
- ã‚«ãƒ¡ãƒ©ä½ç½®ã‚’è¦–ç‚¹ä½ç½®ã«ç§»å‹•ã—ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å¹³é¢ï¼ˆZ=0ï¼‰ã‚’è¦‹ã‚‹ã‚ˆã†ã«è¨­å®š

**ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰:**
- ç”»é¢ã‚µã‚¤ã‚º: 33.8cm Ã— 19.0cmï¼ˆ15.4ã‚¤ãƒ³ãƒã€16:9æƒ³å®šï¼‰
- è¦–è´è·é›¢: 60cm
- è¦–é‡è§’ï¼ˆFOVï¼‰: 50åº¦

### åº§æ¨™å¤‰æ›

MediaPipeæ­£è¦åŒ–åº§æ¨™ `[0, 1]` â†’ Three.jsç‰©ç†åº§æ¨™ï¼ˆcmå˜ä½ï¼‰ï¼š

```javascript
// é¡”ä¸­å¿ƒåº§æ¨™ã‚’å–å¾—
const faceX = detection.boundingBox.originX + detection.boundingBox.width / 2;
const faceY = detection.boundingBox.originY + detection.boundingBox.height / 2;

// æ­£è¦åŒ–åº§æ¨™ [-1, 1] ã«å¤‰æ›
const normalizedX = (faceX - 0.5) * 2;
const normalizedY = (faceY - 0.5) * 2;

// ç‰©ç†åº§æ¨™ã«å¤‰æ›ï¼ˆYè»¸åè»¢ã«æ³¨æ„ï¼‰
const offsetX = normalizedX * (screenWidth / 2) * scale;
const offsetY = -normalizedY * (screenHeight / 2) * scale;
```

### ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :** Exponential Moving Average (EMA)

```javascript
smoothedValue = previousValue Ã— (1 - alpha) + newValue Ã— alpha
```

- X/Yè»¸: alpha = 0.1
- Zè»¸: alpha = 0.15ï¼ˆã‚ˆã‚Šå¼·ã‚ã®ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ï¼‰

## ğŸ¯ å‹•ä½œè¦ä»¶

- **ãƒ–ãƒ©ã‚¦ã‚¶:** Google Chromeï¼ˆæœ€æ–°ç‰ˆï¼‰æ¨å¥¨
- **ã‚«ãƒ¡ãƒ©:** Webã‚«ãƒ¡ãƒ©å¿…é ˆ
- **ç’°å¢ƒ:** HTTPSæ¥ç¶šï¼ˆlocalhosté™¤ãï¼‰
- **WebGL:** å¯¾å¿œå¿…é ˆ

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚«ãƒ¡ãƒ©ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚«ãƒ¡ãƒ©è¨±å¯è¨­å®šã‚’ç¢ºèª
- HTTPSæ¥ç¶šã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆlocalhosté™¤ãï¼‰
- ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚«ãƒ¡ãƒ©ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã‹ç¢ºèª

### é¡”æ¤œå‡ºãŒä¸å®‰å®š

- ç…§æ˜æ¡ä»¶ã‚’æ”¹å–„ï¼ˆæ˜ã‚‹ã„ç’°å¢ƒæ¨å¥¨ï¼‰
- lil-guiã§Smoothingã‚’å¤§ããï¼ˆ0.2-0.3ï¼‰
- æ­£é¢ã‹ã‚‰ã‚«ãƒ¡ãƒ©ã‚’è¦‹ã‚‹

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªã„

- ä»–ã®ã‚¿ãƒ–ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‰ã˜ã‚‹
- ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹ã‹ç¢ºèª
- lil-guiã§Scaleã‚’å°ã•ãèª¿æ•´

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

Copyright (c) 2026 Hiroto302

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## ğŸ™ è¬è¾

- [Three.js](https://threejs.org/) - 3Dã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [MediaPipe](https://developers.google.com/mediapipe) - æ©Ÿæ¢°å­¦ç¿’ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
- [Johnny Lee's Head Tracking Demo](https://www.youtube.com/watch?v=Jd3-eiid-Uw) - ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…ƒ

## ğŸ“š å‚è€ƒè³‡æ–™

- [Off-Axis Projection (Wikipedia)](https://en.wikipedia.org/wiki/Off-axis_projection)
- [Three.js Documentation](https://threejs.org/docs/)
- [MediaPipe Face Detection Guide](https://developers.google.com/mediapipe/solutions/vision/face_detector)

---
